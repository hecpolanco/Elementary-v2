<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Type');
        data.addColumn('number', 'Percent');
        data.addRows([
          [@watson.sentiment_label.capitalize, 3],
          ['Onions', 1],
          ['Olives', 1],
          ['Zucchini', 1],
          ['Pepperoni', 2]
        ]);

        // Set chart options
        var options = {'title':'Positive v. Negative',
                       'width':400,
                       'height':300};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>

  <body>
    

<h1>Lets see the results kids!</h1>
Text: <%= @watson.text %>
<br>
<%= button_to 'Edit Text', edit_watson_path(@watson), :method => :get %>
<br>
Sentiment Analysis:
<br>
<br>
<%= number_to_percentage(@watson.sentiment_score * 100, precision: 1) + " " + @watson.sentiment_label.capitalize %>
<div id="chart_div"></div>
<br>
<br>
Emotion Analysis:
<ul>
<li>Joy: <%= number_to_percentage(@watson.emotion_joy.round(3) * 100, precision: 1) %></li>
<li>Sadness: <%= number_to_percentage(@watson.emotion_sadness.round(3) * 100, precision: 1) %></li>
<li>Fear: <%= number_to_percentage(@watson.emotion_fear.round(3) * 100, precision: 1) %></li>
<li>Disgust: <%= number_to_percentage(@watson.emotion_disgust.round(3) * 100, precision: 1) %></li>
<li>Anger: <%= number_to_percentage(@watson.emotion_anger.round(3) * 100, precision: 1) %></li>
</ul>
<br>
<br>
Keywords:
<br>
<br>
<% @watson.keywords.each do |keyword| %>
    Text: <%= keyword.text.capitalize %><br>
    Relevance: <%= keyword.relevance %><br>
    Count: <%= keyword.count %><br>
    <hr>
    <% end %>
<br>
<br>
Categories:
<br>
<br>
<% @watson.categories.each do |category| %> 
    Label: <%= category.label.capitalize %><br>
    Score: <%= category.score %><br>
    <hr>
<% end %>

<!--Div that will hold the pie chart-->
    </body>
</html>